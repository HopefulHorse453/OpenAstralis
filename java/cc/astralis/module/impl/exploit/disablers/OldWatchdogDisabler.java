package cc.astralis.module.impl.exploit.disablers;

import cc.astralis.Astralis;
import cc.astralis.event.EventTarget;
import cc.astralis.event.events.impl.game.MotionEvent;
import cc.astralis.module.Module;
import cc.astralis.module.SubModule;
import cc.astralis.module.impl.combat.VelocityModule;
import cc.astralis.ui.notifications.render.Notification;
import net.minecraft.world.item.ItemStack;
import net.minecraft.world.item.Items;
import cc.astralis.ui.notifications.NotificationBuilder;

public class OldWatchdogDisabler extends SubModule {
    private boolean didSend;

    public OldWatchdogDisabler(Module module) {
        super(module,"Watchdog");
    }

    @EventTarget
    public void onMotion(MotionEvent event) {

        //if u actually care about it working on other server i'll make it check for the cpp proxy and shit, lmk i guessâ€¦
        boolean isOnHypixel = !mc.isLocalServer() && mc.getCurrentServer() != null && !mc.getCurrentServer().ip.toLowerCase().contains("anticheat");

        for (ItemStack stack : mc.player.getInventory().getNonEquipmentItems()) {
            if (stack.getItem() == Items.COMPASS) {
                return;
            }
        }

        if (mc.player.tickCount <= 200 && isOnHypixel) {
            if (mc.player.onGround())
                mc.player.jumpFromGround();
            else {
                if (!didSend) {
                    NotificationBuilder.create()
                            .notification("Disabling, Please Stay Still!", Notification.NotificationType.INFO)
                            .duration(5000)
                            .build();
                    didSend = true;
                }

                if (Astralis.getInstance().getModuleManager().getModule(VelocityModule.class).isToggled())
                    Astralis.getInstance().getModuleManager().getModule(VelocityModule.class).setToggled(false);

                /*  if (offGroundTicks >= 9) {*/
                if (offGroundTicks % 2 == 0) {
                    event.setX(event.getX() + 0.095);
                    event.setZ(event.getZ() + 0.095);
                    event.setYaw(360);
                }

                mc.player.setDeltaMovement(0, 0, 0);
            }
          /*  }*/
        } else {
            didSend = false;
            if (!Astralis.getInstance().getModuleManager().getModule(VelocityModule.class).isToggled())
                Astralis.getInstance().getModuleManager().getModule(VelocityModule.class).setToggled(true);
        }
    }
}
